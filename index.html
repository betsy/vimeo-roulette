 <!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Vimeo Roulette</title>
</head>
<body style = "text-align:center">

<h1>Shitty Vimeo Roulette</h1>
<p>Plays a random vimeo video. Proceed with caution</p>

<div id="myVideo"></div>

<script src="https://player.vimeo.com/api/player.js"></script>
<script type="text/javascript">


const threshold = 450000000; // generate random video ids between 0 and this value

function tryUntilSuccess(vp, retries)
{
	if (!retries) return 0;

	new_video_id = Math.round(Math.random(new Date().getMilliseconds())*threshold);
	console.log("new video id: "+new_video_id+". retries left: "+retries);
    return vp.loadVideo("https://player.vimeo.com/video/"+new_video_id).catch(rej => {
		console.log("reject: "+rej);
		tryUntilSuccess(vp, retries-1);
    });
}


var videoPlayer;
window.onload = function(e){
	var options = {
		url: "https://player.vimeo.com/video/350477474/", // default, blank video
		width: 800
	};

	videoPlayer = new Vimeo.Player('myVideo', options);;
	tryUntilSuccess(videoPlayer, 30);
}
</script>

</body>
</html> 
